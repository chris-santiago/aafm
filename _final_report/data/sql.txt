Select FD.fundRUN,FD.fundName,FD.fundSeries,FD.aafmCategory,FD.svsCategory,FD.svsCategoryId,FD.currency
,FD.fundRUN || FD.fundSeries AS fundRUNSeries
,MAX(CASE WHEN FP.fecha = '2015-01-31' THEN FP.installmentValue END) AS '2015-01-31'
,MAX(CASE WHEN FP.fecha = '2015-02-28' THEN FP.installmentValue END) AS '2015-02-28'
,MAX(CASE WHEN FP.fecha = '2015-03-31' THEN FP.installmentValue END) AS '2015-03-31'
,MAX(CASE WHEN FP.fecha = '2015-04-30' THEN FP.installmentValue END) AS '2015-04-30'
,MAX(CASE WHEN FP.fecha = '2015-05-31' THEN FP.installmentValue END) AS '2015-05-31'
,MAX(CASE WHEN FP.fecha = '2015-06-30' THEN FP.installmentValue END) AS '2015-06-30'
,MAX(CASE WHEN FP.fecha = '2015-07-31' THEN FP.installmentValue END) AS '2015-07-31'
,MAX(CASE WHEN FP.fecha = '2015-08-31' THEN FP.installmentValue END) AS '2015-08-31'
,MAX(CASE WHEN FP.fecha = '2015-09-30' THEN FP.installmentValue END) AS '2015-09-30'
,MAX(CASE WHEN FP.fecha = '2015-10-31' THEN FP.installmentValue END) AS '2015-10-31'
,MAX(CASE WHEN FP.fecha = '2015-11-30' THEN FP.installmentValue END) AS '2015-11-30'
,MAX(CASE WHEN FP.fecha = '2015-12-31' THEN FP.installmentValue END) AS '2015-12-31'
,MAX(CASE WHEN FP.fecha = '2016-01-31' THEN FP.installmentValue END) AS '2016-01-31'
,MAX(CASE WHEN FP.fecha = '2016-02-29' THEN FP.installmentValue END) AS '2016-02-29'
,MAX(CASE WHEN FP.fecha = '2016-03-31' THEN FP.installmentValue END) AS '2016-03-31'
,MAX(CASE WHEN FP.fecha = '2016-04-30' THEN FP.installmentValue END) AS '2016-04-30'
,MAX(CASE WHEN FP.fecha = '2016-05-31' THEN FP.installmentValue END) AS '2016-05-31'
,MAX(CASE WHEN FP.fecha = '2016-06-30' THEN FP.installmentValue END) AS '2016-06-30'
,MAX(CASE WHEN FP.fecha = '2016-07-31' THEN FP.installmentValue END) AS '2016-07-31'
,MAX(CASE WHEN FP.fecha = '2016-08-31' THEN FP.installmentValue END) AS '2016-08-31'
,MAX(CASE WHEN FP.fecha = '2016-09-30' THEN FP.installmentValue END) AS '2016-09-30'
,MAX(CASE WHEN FP.fecha = '2016-10-31' THEN FP.installmentValue END) AS '2016-10-31'
,MAX(CASE WHEN FP.fecha = '2016-11-30' THEN FP.installmentValue END) AS '2016-11-30'
,MAX(CASE WHEN FP.fecha = '2016-12-31' THEN FP.installmentValue END) AS '2016-12-31'
,MAX(CASE WHEN FP.fecha = '2017-01-31' THEN FP.installmentValue END) AS '2017-01-31'
,MAX(CASE WHEN FP.fecha = '2017-02-28' THEN FP.installmentValue END) AS '2017-02-28'
,MAX(CASE WHEN FP.fecha = '2017-03-31' THEN FP.installmentValue END) AS '2017-03-31'
,MAX(CASE WHEN FP.fecha = '2017-04-30' THEN FP.installmentValue END) AS '2017-04-30'
,MAX(CASE WHEN FP.fecha = '2017-05-31' THEN FP.installmentValue END) AS '2017-05-31'
,MAX(CASE WHEN FP.fecha = '2017-06-30' THEN FP.installmentValue END) AS '2017-06-30'
,MAX(CASE WHEN FP.fecha = '2017-07-31' THEN FP.installmentValue END) AS '2017-07-31'
,MAX(CASE WHEN FP.fecha = '2017-08-31' THEN FP.installmentValue END) AS '2017-08-31'
,MAX(CASE WHEN FP.fecha = '2017-09-30' THEN FP.installmentValue END) AS '2017-09-30'
,MAX(CASE WHEN FP.fecha = '2017-10-31' THEN FP.installmentValue END) AS '2017-10-31'
,MAX(CASE WHEN FP.fecha = '2017-11-30' THEN FP.installmentValue END) AS '2017-11-30'
,MAX(CASE WHEN FP.fecha = '2017-12-31' THEN FP.installmentValue END) AS '2017-12-31'
,MAX(CASE WHEN FP.fecha = '2018-01-31' THEN FP.installmentValue END) AS '2018-01-31'
,MAX(CASE WHEN FP.fecha = '2018-02-28' THEN FP.installmentValue END) AS '2018-02-28'
,MAX(CASE WHEN FP.fecha = '2018-03-31' THEN FP.installmentValue END) AS '2018-03-31'
,MAX(CASE WHEN FP.fecha = '2018-04-30' THEN FP.installmentValue END) AS '2018-04-30'
,MAX(CASE WHEN FP.fecha = '2018-05-31' THEN FP.installmentValue END) AS '2018-05-31'
,MAX(CASE WHEN FP.fecha = '2018-06-30' THEN FP.installmentValue END) AS '2018-06-30'
,MAX(CASE WHEN FP.fecha = '2018-07-31' THEN FP.installmentValue END) AS '2018-07-31'
,MAX(CASE WHEN FP.fecha = '2018-08-31' THEN FP.installmentValue END) AS '2018-08-31'
,MAX(CASE WHEN FP.fecha = '2018-09-30' THEN FP.installmentValue END) AS '2018-09-30'
,MAX(CASE WHEN FP.fecha = '2018-10-31' THEN FP.installmentValue END) AS '2018-10-31'
,MAX(CASE WHEN FP.fecha = '2018-11-30' THEN FP.installmentValue END) AS '2018-11-30'
,MAX(CASE WHEN FP.fecha = '2018-12-31' THEN FP.installmentValue END) AS '2018-12-31'
,MAX(CASE WHEN FP.fecha = '2019-01-31' THEN FP.installmentValue END) AS '2019-01-31'
,MAX(CASE WHEN FP.fecha = '2019-02-28' THEN FP.installmentValue END) AS '2019-02-28'
,MAX(CASE WHEN FP.fecha = '2019-03-31' THEN FP.installmentValue END) AS '2019-03-31'
,MAX(CASE WHEN FP.fecha = '2019-04-30' THEN FP.installmentValue END) AS '2019-04-30'
,MAX(CASE WHEN FP.fecha = '2019-05-31' THEN FP.installmentValue END) AS '2019-05-31'
,MAX(CASE WHEN FP.fecha = '2019-06-30' THEN FP.installmentValue END) AS '2019-06-30'
,MAX(CASE WHEN FP.fecha = '2019-07-31' THEN FP.installmentValue END) AS '2019-07-31'
,MAX(CASE WHEN FP.fecha = '2019-08-31' THEN FP.installmentValue END) AS '2019-08-31'
,MAX(CASE WHEN FP.fecha = '2019-09-30' THEN FP.installmentValue END) AS '2019-09-30'
,MAX(CASE WHEN FP.fecha = '2019-10-31' THEN FP.installmentValue END) AS '2019-10-31'
,MAX(CASE WHEN FP.fecha = '2019-11-30' THEN FP.installmentValue END) AS '2019-11-30'
,MAX(CASE WHEN FP.fecha = '2019-12-31' THEN FP.installmentValue END) AS '2019-12-31'
,MAX(CASE WHEN FP.fecha = '2020-01-31' THEN FP.installmentValue END) AS '2020-01-31'
,MAX(CASE WHEN FP.fecha = '2020-02-29' THEN FP.installmentValue END) AS '2020-02-29'
,MAX(CASE WHEN FP.fecha = '2020-03-31' THEN FP.installmentValue END) AS '2020-03-31'
,MAX(CASE WHEN FP.fecha = '2020-04-30' THEN FP.installmentValue END) AS '2020-04-30'
,MAX(CASE WHEN FP.fecha = '2020-05-31' THEN FP.installmentValue END) AS '2020-05-31'
,MAX(CASE WHEN FP.fecha = '2020-06-30' THEN FP.installmentValue END) AS '2020-06-30'
,MAX(CASE WHEN FP.fecha = '2020-07-31' THEN FP.installmentValue END) AS '2020-07-31'
,MAX(CASE WHEN FP.fecha = '2020-08-31' THEN FP.installmentValue END) AS '2020-08-31'
,MAX(CASE WHEN FP.fecha = '2020-09-30' THEN FP.installmentValue END) AS '2020-09-30'
,MAX(CASE WHEN FP.fecha = '2020-10-31' THEN FP.installmentValue END) AS '2020-10-31'
,MAX(CASE WHEN FP.fecha = '2020-11-30' THEN FP.installmentValue END) AS '2020-11-30'
,MAX(CASE WHEN FP.fecha = '2020-12-31' THEN FP.installmentValue END) AS '2020-12-31'
,MAX(CASE WHEN FP.fecha = '2021-01-31' THEN FP.installmentValue END) AS '2021-01-31'

from fundData FD
JOIN fundprices FP on FP.fundSeries = FD.fundSeries and FP.fundName = FD.fundName
where FP.fundSeries is not NULL
--and FP.fundname = 'CAPITALISA-ACC'
and strftime("%m", fecha) != strftime("%m", fecha, "+1 day")
group by FP.fundName,FP.fundSeries